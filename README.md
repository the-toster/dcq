# Dockerized code quality tools

Набор инструментов для проверки качества PHP кода, запускаемый из докера.

Состоит из:
- имейджа с последними версиями инструментов (`the-toster/dcq`),
- консольного скрипта `dcq`, который позволяет удобно запускать тулзы, как будто они на хосте: `dcq psalm`
- TODO: скрипт установки: локально создает `dcq` в `~/.local/bin/` или аналогичном месте
- TODO: github actions чтоб билдить образ и скрипты

## Установка

```shell
curl ... | sh
```

### Как пользоваться локально:
```shell
cd your_project
dcq psalm --init
dcq psalm
```

### WIP Как пользоваться в `CI`:
```yaml
image: the-toster/dcq:latest # или указать версию PHP: the-toster/dcq:8.1
```


## Что тут есть / должно быть:

### ./docker-image/ 
Сам образ, скрипт установки инструментов (имя пакета надо добавить в `packages.txt`).  
Скрипт установки добавляет пути до `vendor/bin` каждого инструмента в `paths.sh` (там `export PATH=$PATH...`).  
Скрипт энтрипоинта выполняет `. paths.sh`, таким образом можно передать имя любого бинарника и он запустится.  

### ./shell-helper/

`dcq` - шелл скрипт запуска инструментов, который подставляет текущую папку в вольюм и задает юзера, используется для локального прогона проверок.  

Его нужно как-то прописать в path, для этого создаю симлинк в `~/.local/bin/` при помощи `make-dev-symlink.sh`  

И тут же должен быть скрипт установки через курл.

